<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Harvard Standard Resume Builder (V23)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    /* === RESET & BASE === */
    :root { --sidebar-w: 400px; --bg: #e2e8f0; --primary: #0f172a; --accent: #2563eb; }
    * { box-sizing: border-box; outline: none; }
    body { margin: 0; display: flex; height: 100vh; font-family: 'Segoe UI', sans-serif; background: var(--bg); overflow: hidden; }

    /* === LEFT SIDEBAR (EDITOR) === */
    .editor {
        width: var(--sidebar-w); background: #fff; border-right: 1px solid #ccc;
        display: flex; flex-direction: column; z-index: 10;
        box-shadow: 4px 0 15px rgba(0,0,0,0.1);
    }
    .editor-header {
        padding: 15px 20px; background: var(--primary); color: white;
        display: flex; justify-content: space-between; align-items: center;
    }
    .editor-body { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 20px; }

    /* Inputs */
    .section-label { font-size: 11px; font-weight: 800; text-transform: uppercase; color: #64748b; margin-bottom: 5px; letter-spacing: 1px; }
    input, textarea {
        width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 4px;
        font-size: 13px; font-family: inherit; margin-bottom: 8px; transition: 0.2s;
        background: #f8fafc;
    }
    input:focus, textarea:focus { border-color: var(--accent); background: #fff; }
    textarea { resize: vertical; min-height: 60px; }

    /* Buttons */
    .btn { padding: 10px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 13px; width: 100%; }
    .btn-primary { background: var(--accent); color: white; margin-top: 10px; }
    .btn-ghost { background: #f1f5f9; color: #475569; border: 1px dashed #cbd5e1; margin-top: 5px; }
    .btn-danger { color: #ef4444; background: transparent; width: auto; font-size: 11px; padding: 5px; }

    /* Dynamic Item Card */
    .card { background: #f8fafc; border: 1px solid #e2e8f0; padding: 10px; border-radius: 4px; margin-bottom: 5px; position: relative; }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }

    /* === RIGHT PREVIEW (A4 PAPER) === */
    .preview-area {
        flex: 1; display: flex; justify-content: center; overflow-y: auto; padding: 40px; background: #525659;
    }
    
    /* HARVARD TEMPLATE STYLES (Strict & Clean) */
    #resume {
        width: 210mm; min-height: 297mm; background: white; 
        padding: 0.5in 0.5in; /* Standard Margins */
        box-shadow: 0 0 20px rgba(0,0,0,0.5);
        font-family: 'Times New Roman', Times, serif; /* The ATS Standard */
        color: #000; line-height: 1.3;
        text-align: left; direction: ltr; /* Force LTR */
    }

    .cv-name { text-align: center; font-size: 20pt; font-weight: bold; text-transform: uppercase; margin-bottom: 4pt; }
    .cv-contact { text-align: center; font-size: 10pt; margin-bottom: 12pt; }
    .cv-section-title {
        font-size: 11pt; font-weight: bold; text-transform: uppercase;
        border-bottom: 1px solid #000; margin-top: 10pt; margin-bottom: 6pt;
        padding-bottom: 2pt;
    }
    
    .cv-item { margin-bottom: 6pt; }
    .cv-header-row { display: flex; justify-content: space-between; font-size: 11pt; font-weight: bold; }
    .cv-sub-row { display: flex; justify-content: space-between; font-size: 11pt; font-style: italic; margin-bottom: 2pt; }
    .cv-bullets { margin: 0; padding-left: 15pt; font-size: 10.5pt; text-align: justify; }
    .cv-bullets li { margin-bottom: 2pt; }

    /* PRINT FIX */
    @media print {
        body { display: block; background: white; }
        .editor { display: none; }
        .preview-area { padding: 0; margin: 0; background: white; }
        #resume { width: 100%; height: auto; box-shadow: none; margin: 0; padding: 0; }
        @page { size: A4; margin: 0.5in; }
    }
</style>
</head>
<body>

<div class="editor">
    <div class="editor-header">
        <span style="font-weight:bold;">Harvard Builder</span>
        <button onclick="loadDemo()" style="background:rgba(255,255,255,0.2); border:none; color:white; padding:4px 8px; border-radius:4px; cursor:pointer; font-size:11px;">Load Demo</button>
    </div>
    
    <div class="editor-body">
        
        <div class="section-label">01. Header</div>
        <input id="inName" placeholder="Full Name" oninput="draw()">
        <input id="inLoc" placeholder="City, Country" oninput="draw()">
        <div style="display:flex; gap:5px;">
            <input id="inPhone" placeholder="Phone" oninput="draw()">
            <input id="inEmail" placeholder="Email" oninput="draw()">
        </div>
        <input id="inLink" placeholder="LinkedIn / Portfolio" oninput="draw()">

        <div class="section-label">02. Education</div>
        <div id="eduList"></div>
        <button class="btn btn-ghost" onclick="addEdu()">+ Add Education</button>

        <div class="section-label">03. Experience</div>
        <div id="expList"></div>
        <button class="btn btn-ghost" onclick="addExp()">+ Add Experience</button>

        <div class="section-label">04. Skills</div>
        <textarea id="inSkills" placeholder="Computer: Python, SQL...&#10;Languages: English, Arabic..." oninput="draw()"></textarea>

        <button class="btn btn-primary" onclick="window.print()">
            <i class="fa-solid fa-download"></i> Save as PDF
        </button>
    </div>
</div>

<div class="preview-area">
    <div id="resume">
        <div class="cv-name" id="outName">YOUR NAME</div>
        <div class="cv-contact" id="outContact">City, Country | phone | email</div>

        <div class="cv-section-title">Education</div>
        <div id="outEdu"></div>

        <div class="cv-section-title">Professional Experience</div>
        <div id="outExp"></div>

        <div class="cv-section-title">Additional Skills</div>
        <div id="outSkills" class="cv-bullets" style="list-style:none; padding:0;"></div>
    </div>
</div>

<script>
// --- STATE MANAGEMENT ---
let data = {
    name: "", loc: "", phone: "", email: "", link: "",
    edus: [],
    exps: [],
    skills: ""
};

// --- INIT ---
window.onload = () => {
    // Attempt to load local storage
    const saved = localStorage.getItem('harvardCV');
    if(saved) {
        data = JSON.parse(saved);
        restoreInputs();
    } else {
        addEdu(); addExp();
    }
    draw();
};

// --- RENDER FUNCTIONS (THE CORE) ---
function draw() {
    // 1. Save to Storage
    data.name = val('inName');
    data.loc = val('inLoc');
    data.phone = val('inPhone');
    data.email = val('inEmail');
    data.link = val('inLink');
    data.skills = val('inSkills');
    localStorage.setItem('harvardCV', JSON.stringify(data));

    // 2. Render Header
    txt('outName', data.name || "YOUR NAME");
    let contact = [data.loc, data.phone, data.email, data.link].filter(Boolean).join(" | ");
    txt('outContact', contact);

    // 3. Render Education
    const eduHTML = data.edus.map(e => `
        <div class="cv-item">
            <div class="cv-header-row">
                <span>${e.uni}</span>
                <span>${e.loc}</span>
            </div>
            <div class="cv-sub-row">
                <span>${e.deg}</span>
                <span>${e.date}</span>
            </div>
        </div>
    `).join('');
    document.getElementById('outEdu').innerHTML = eduHTML;

    // 4. Render Experience
    const expHTML = data.exps.map(e => `
        <div class="cv-item">
            <div class="cv-header-row">
                <span>${e.role}</span>
                <span>${e.date}</span>
            </div>
            <div class="cv-sub-row">
                <span>${e.comp}</span>
                <span>${e.loc}</span>
            </div>
            <ul class="cv-bullets">
                ${e.desc.split('\n').map(line => line.trim() ? `<li>${line.replace(/^[•-]\s*/, '')}</li>` : '').join('')}
            </ul>
        </div>
    `).join('');
    document.getElementById('outExp').innerHTML = expHTML;

    // 5. Render Skills (Lines)
    const skillLines = data.skills.split('\n').map(l => l.trim() ? `<div>${l}</div>` : '').join('');
    document.getElementById('outSkills').innerHTML = skillLines;
}

// --- DYNAMIC INPUTS ---
function addEdu() {
    data.edus.push({ uni: "", loc: "", deg: "", date: "" });
    renderEduInputs(); draw();
}
function addExp() {
    data.exps.push({ role: "", comp: "", loc: "", date: "", desc: "" });
    renderExpInputs(); draw();
}

function renderEduInputs() {
    const container = document.getElementById('eduList');
    container.innerHTML = data.edus.map((e, i) => `
        <div class="card">
            <div class="card-header">
                <span style="font-size:10px; font-weight:bold; color:#aaa;">DEGREE ${i+1}</span>
                <button class="btn-danger" onclick="removeEdu(${i})">Remove</button>
            </div>
            <input placeholder="University Name" value="${e.uni}" oninput="data.edus[${i}].uni=this.value; draw()">
            <input placeholder="Degree (e.g. B.S. Computer Science)" value="${e.deg}" oninput="data.edus[${i}].deg=this.value; draw()">
            <div style="display:flex; gap:5px;">
                <input placeholder="Location" value="${e.loc}" oninput="data.edus[${i}].loc=this.value; draw()">
                <input placeholder="Year" value="${e.date}" oninput="data.edus[${i}].date=this.value; draw()">
            </div>
        </div>
    `).join('');
}

function renderExpInputs() {
    const container = document.getElementById('expList');
    container.innerHTML = data.exps.map((e, i) => `
        <div class="card">
            <div class="card-header">
                <span style="font-size:10px; font-weight:bold; color:#aaa;">ROLE ${i+1}</span>
                <button class="btn-danger" onclick="removeExp(${i})">Remove</button>
            </div>
            <input placeholder="Job Title" value="${e.role}" oninput="data.exps[${i}].role=this.value; draw()" style="font-weight:bold;">
            <input placeholder="Company" value="${e.comp}" oninput="data.exps[${i}].comp=this.value; draw()">
            <div style="display:flex; gap:5px;">
                <input placeholder="Location" value="${e.loc}" oninput="data.exps[${i}].loc=this.value; draw()">
                <input placeholder="Date" value="${e.date}" oninput="data.exps[${i}].date=this.value; draw()">
            </div>
            <textarea placeholder="• Achievement 1&#10;• Achievement 2" oninput="data.exps[${i}].desc=this.value; draw()">${e.desc}</textarea>
        </div>
    `).join('');
}

function removeEdu(i) { data.edus.splice(i, 1); renderEduInputs(); draw(); }
function removeExp(i) { data.exps.splice(i, 1); renderExpInputs(); draw(); }

// --- HELPERS ---
function val(id) { return document.getElementById(id).value; }
function txt(id, t) { document.getElementById(id).innerText = t; }

function restoreInputs() {
    document.getElementById('inName').value = data.name;
    document.getElementById('inLoc').value = data.loc;
    document.getElementById('inPhone').value = data.phone;
    document.getElementById('inEmail').value = data.email;
    document.getElementById('inLink').value = data.link;
    document.getElementById('inSkills').value = data.skills;
    renderEduInputs();
    renderExpInputs();
}

function loadDemo() {
    data = {
        name: "KARIM AHMED", loc: "Cairo, Egypt", phone: "+20 100 123 4567", email: "karim@example.com", link: "linkedin.com/in/karim",
        edus: [{ uni: "Cairo University", loc: "Giza, Egypt", deg: "Bachelor of Science in Computer Engineering", date: "May 2020" }],
        exps: [{ role: "Senior Software Engineer", comp: "Tech Solutions", loc: "Cairo", date: "Jan 2021 – Present", desc: "Spearheaded the development of a new ATS-friendly resume builder, increasing user retention by 40%.\nOptimized database queries, reducing load times by 2 seconds." }],
        skills: "Languages: Arabic (Native), English (Fluent)\nTechnical: HTML, CSS, JavaScript, React, Python"
    };
    restoreInputs();
    draw();
}
</script>

</body>
    </html>
    
