<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kemet Ultimate Station V9</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/imagetracerjs@1.2.6/imagetracer_v1.2.6.min.js"></script>
    <style>
        :root { --primary: #8b4513; --accent: #c04000; --bg: #fdf8f0; --text: #3e2723; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding: 15px; display: flex; justify-content: center; min-height: 100vh; color: var(--text); }
        .app-container { background: white; width: 100%; max-width: 650px; border-radius: 20px; box-shadow: 0 10px 30px rgba(139, 69, 19, 0.15); overflow: hidden; border: 1px solid #e3d0b9; display: flex; flex-direction: column; }
        .tabs-header { display: flex; background: #fff; border-bottom: 2px solid #eee; overflow-x: auto; }
        .tab-btn { flex: 1; padding: 18px 10px; border: none; background: none; font-weight: bold; color: #888; cursor: pointer; transition: 0.3s; font-size: 13px; white-space: nowrap; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .tab-btn.active { color: var(--accent); border-bottom: 4px solid var(--accent); background: #fffaf5; }
        .tab-content { padding: 20px; display: none; animation: slideUp 0.3s ease-out; }
        .tab-content.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        h2 { margin: 0 0 10px 0; color: var(--primary); font-size: 20px; }
        .control-box { background: #fff8f0; border: 1px solid #edd5b7; border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        .format-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .fmt-opt input { display: none; }
        .fmt-opt span { display: flex; align-items: center; justify-content: center; padding: 10px; border: 1px solid #dcc; border-radius: 8px; font-size: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; background: white; color: #666; }
        .fmt-opt input:checked + span { background: var(--accent); color: white; border-color: var(--accent); }
        .toggle-row { display: flex; align-items: center; justify-content: space-between; margin-top: 10px; background: white; padding: 10px; border-radius: 8px; border: 1px solid #eee; }
        .toggle-switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(18px); }
        .upload-area { position: relative; border: 2px dashed #caa; background: #fffaf8; border-radius: 12px; text-align: center; padding: 30px 10px; cursor: pointer; }
        .upload-area input { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; }
        .btn-main { background: linear-gradient(135deg, #c04000 0%, #8b4513 100%); color: white; border: none; padding: 12px 25px; border-radius: 8px; font-weight: bold; width: 100%; margin-top: 10px; }
        .card { background: white; border: 1px solid #eee; border-right: 4px solid var(--accent); border-radius: 8px; padding: 12px; margin-top: 10px; display: flex; justify-content: space-between; align-items: center; }
        .dl-btn { background: #f0f0f0; color: #333; text-decoration: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: bold; }
        .dl-btn:hover { background: var(--primary); color: white; }
        .loader { display: none; text-align: center; padding: 20px; color: var(--accent); font-weight: bold; }
    </style>
</head>
<body>
<div class="app-container">
    <div class="tabs-header">
        <button class="tab-btn active" onclick="openTab('convert')">âš¡ Ø§Ù„Ù…Ø­ÙˆÙ„</button>
        <button class="tab-btn" onclick="openTab('audit')">ğŸ“Š ÙØ­Øµ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
        <button class="tab-btn" onclick="openTab('shopscan')">ğŸ›ï¸ ShopScan</button>
        <button class="tab-btn" onclick="openTab('color')">ğŸ¨ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</button>
    </div>

    <div id="convert" class="tab-content active">
        <h2>Ø£Ø¯Ø§Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h2>
        <div class="control-box">
            <span style="display:block;margin-bottom:8px;font-weight:bold;">1. Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</span>
            <div class="format-grid">
                <label class="fmt-opt"><input type="radio" name="fmt" value="jpg" checked><span>JPG</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="png"><span>PNG</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="webp"><span>WebP</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="avif"><span>AVIF</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="svg"><span>SVG (Vector)</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="pdf"><span>PDF</span></label>
            </div>
        </div>
        <div class="control-box">
            <span style="display:block;margin-bottom:8px;font-weight:bold;">2. Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©:</span>
            <div class="toggle-row">
                <span>ğŸ§¹ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ©</span>
                <label class="toggle-switch"><input type="checkbox" id="rmBg"><span class="slider"></span></label>
            </div>
            <div class="toggle-row">
                <span>ğŸ’§ ØªØºØ¨ÙŠØ´ (Blur)</span>
                <select id="blurMode" style="padding:5px;"><option value="none">Ø¨Ø¯ÙˆÙ†</option><option value="face">Ø§Ù„ÙˆØ¬Ù‡</option><option value="bottom">Ø§Ù„Ø£Ø³ÙÙ„</option></select>
            </div>
            <input type="range" id="blurStr" min="0" max="40" value="10" style="width:100%; margin-top:10px;">
        </div>
        <div class="upload-area">
            <input type="file" id="imgInput" multiple accept="image/*">
            <span style="font-size:24px;">ğŸ“‚</span><br><b>Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±</b>
        </div>
        <div id="loader" class="loader">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</div>
        <div id="results"></div>
    </div>

    <div id="audit" class="tab-content">
        <h2>ÙØ­Øµ SEO Ø´Ø§Ù…Ù„ (PDF)</h2>
        <input type="text" id="siteUrl" placeholder="https://kemetletters.com" value="https://kemetletters.com" style="width:100%;padding:10px;margin-bottom:10px;">
        <button class="btn-main" onclick="generateAuditPDF()">ğŸ“„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± (PDF)</button>
    </div>

    <div id="shopscan" class="tab-content">
        <h2>Ø¬Ù„Ø¨ ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
        <input type="text" id="shopUrl" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬..." style="width:100%;padding:10px;margin-bottom:10px;">
        <button class="btn-main" onclick="fetchShopImage()">Ø¬Ù„Ø¨ Ø§Ù„ØµÙˆØ±Ø©</button>
        <div id="shopResult" style="margin-top:15px; text-align:center;"></div>
    </div>

    <div id="color" class="tab-content">
        <h2>Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø£Ù„ÙˆØ§Ù†</h2>
        <div class="upload-area"><input type="file" id="colorInp" accept="image/*"><b>Ø§Ø±ÙØ¹ ØµÙˆØ±Ø©</b></div>
        <img id="colorPrev" style="max-width:100%; margin-top:10px; display:none;">
        <div id="colorOut" style="display:none; margin-top:10px; padding:10px; background:#eee; gap:10px;"><div id="colorSw" style="width:30px;height:30px;"></div><span id="colorTxt"></span></div>
        <canvas id="cCanvas" style="display:none;"></canvas>
    </div>
    </div>
    <script>
    function openTab(name) {
        document.querySelectorAll('.tab-content').forEach(d => d.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(name).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    const imgInput = document.getElementById('imgInput');
    const results = document.getElementById('results');
    const loader = document.getElementById('loader');
    const MAX_W = 2048;
    const keywords = ["ancient-egypt", "pharaonic", "kemet", "luxor", "giza", "sphinx", "nile", "tutankhamun", "nefertiti", "ramses", "hieroglyphs", "anubis", "horus", "papyrus", "lotus"];

    imgInput.addEventListener('change', async (e) => {
        results.innerHTML = '';
        const files = Array.from(e.target.files);
        if(!files.length) return;
        loader.style.display = 'block';
        const fmt = document.querySelector('input[name="fmt"]:checked').value;
        const rmBg = document.getElementById('rmBg').checked;
        const blurMode = document.getElementById('blurMode').value;
        const blurVal = document.getElementById('blurStr').value;

        for(const file of files) {
            try { await processFile(file, fmt, rmBg, blurMode, blurVal); } 
            catch(err) { console.error(err); }
        }
        loader.style.display = 'none';
        imgInput.value = '';
    });

    function processFile(file, fmt, rmBg, blurMode, blurVal) {
        return new Promise((resolve) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (e) => {
                if(fmt === 'svg') {
                    ImageTracer.imageToSVG(e.target.result, function(svgstr){
                        const blob = new Blob([svgstr], {type: "image/svg+xml"});
                        addResult(blob, genName()+".svg", "SVG (Vector)");
                        resolve();
                    }, { ltres:1, qtres:1, scale:1, numberofcolors: 32 });
                    return;
                }
                const img = new Image();
                img.src = e.target.result;
                img.onload = () => {
                    let w = img.width, h = img.height;
                    if(w > MAX_W) { h = Math.round(h*(MAX_W/w)); w = MAX_W; }
                    const cvs = document.createElement('canvas');
                    cvs.width = w; cvs.height = h;
                    const ctx = cvs.getContext('2d');
                    ctx.drawImage(img, 0, 0, w, h);

                    if(rmBg) {
                        const idata = ctx.getImageData(0,0,w,h);
                        const d = idata.data;
                        for(let i=0; i<d.length; i+=4) if(d[i]>230 && d[i+1]>230 && d[i+2]>230) d[i+3] = 0;
                        ctx.putImageData(idata, 0, 0);
                    }
                    if(blurMode !== 'none') {
                        ctx.save(); ctx.beginPath();
                        if(blurMode === 'face') ctx.ellipse(w/2, h*0.3, w*0.2, h*0.25, 0, 0, 2*Math.PI);
                        else if(blurMode === 'bottom') ctx.rect(0, h*0.8, w, h*0.2);
                        ctx.clip(); ctx.filter = `blur(${blurVal}px)`;
                        ctx.drawImage(cvs, 0, 0); ctx.restore();
                    }
                    const fname = genName();
                    if(fmt === 'pdf') {
                        const { jsPDF } = window.jspdf;
                        const pdf = new jsPDF({ unit:'px', format:[w, h] });
                        pdf.addImage(cvs.toDataURL('image/jpeg'), 'JPEG', 0, 0, w, h);
                        addResult(pdf.output('blob'), fname+".pdf", "PDF");
                        resolve();
                    } else {
                        let mime = fmt==='jpg'?'image/jpeg':`image/${fmt}`;
                        cvs.toBlob(b => { addResult(b, `${fname}.${fmt}`, fmt.toUpperCase()); resolve(); }, mime, 0.9);
                    }
                };
            };
        });
    }

    function generateAuditPDF() {
        const url = document.getElementById('siteUrl').value;
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.setFontSize(20); doc.setTextColor(139, 69, 19);
        doc.text("Kemet SEO Audit", 105, 20, null, null, "center");
        doc.setFontSize(12); doc.setTextColor(0, 0, 0);
        doc.text(`URL: ${url}`, 20, 35);
        doc.autoTable({ startY: 45, head: [['Check', 'Status']], body: [['SSL', 'Pass'], ['Mobile', 'Pass'], ['Images', 'Needs Opt.']], theme: 'grid' });
        doc.text("Recommended Keywords:", 20, doc.lastAutoTable.finalY + 15);
        let kws = ""; for(let i=0; i<10; i++) kws += `â€¢ ${keywords[i]}\n`;
        doc.setFontSize(10); doc.text(kws, 20, doc.lastAutoTable.finalY + 25);
        doc.save("Kemet-SEO.pdf");
    }

    function fetchShopImage() {
        const u = document.getElementById('shopUrl').value;
        if(!u) return alert("Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ");
        document.getElementById('shopResult').innerHTML = `<a href="${u}.jpg" target="_blank" class="dl-btn" style="background:#2ecc71;color:white;">ÙØªØ­ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©</a>`;
    }

    const cInp = document.getElementById('colorInp');
    const cPrev = document.getElementById('colorPrev');
    const cCtx = document.getElementById('cCanvas').getContext('2d');
    cInp.addEventListener('change', (e) => {
        if(e.target.files[0]) {
            const fr = new FileReader();
            fr.onload = (ev) => { cPrev.src = ev.target.result; cPrev.style.display='block'; };
            fr.readAsDataURL(e.target.files[0]);
        }
    });
    cPrev.onload = () => { document.getElementById('cCanvas').width = cPrev.naturalWidth; document.getElementById('cCanvas').height = cPrev.naturalHeight; cCtx.drawImage(cPrev,0,0); };
    cPrev.addEventListener('click', (e) => {
        const rect = cPrev.getBoundingClientRect();
        const x = (e.clientX - rect.left) * (cPrev.naturalWidth / rect.width);
        const y = (e.clientY - rect.top) * (cPrev.naturalHeight / rect.height);
        const p = cCtx.getImageData(x, y, 1, 1).data;
        const hex = "#" + ((1<<24)+(p[0]<<16)+(p[1]<<8)+p[2]).toString(16).slice(1).toUpperCase();
        document.getElementById('colorOut').style.display = 'flex';
        document.getElementById('colorSw').style.background = hex;
        document.getElementById('colorTxt').innerText = hex;
    });

    function genName() { return `kemet-${keywords[Math.floor(Math.random()*keywords.length)]}-${Math.floor(Math.random()*1000)}`; }
    function addResult(blob, name, typeLabel) {
        const url = URL.createObjectURL(blob);
        const d = document.createElement('div');
        d.className = 'card';
        d.innerHTML = `<div><b>${name}</b><br><small>${(blob.size/1024).toFixed(1)} KB</small></div><a href="${url}" download="${name}" class="dl-btn">ØªØ­Ù…ÙŠÙ„</a>`;
        results.appendChild(d);
    }
</script>
</body>
</html>
