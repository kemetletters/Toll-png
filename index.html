<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kemet Ultimate Station V9</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/imagetracerjs@1.2.6/imagetracer_v1.2.6.min.js"></script>
    
    <style>
        :root { --primary: #8b4513; --accent: #c04000; --bg: #fdf8f0; --text: #3e2723; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding: 15px; display: flex; justify-content: center; min-height: 100vh; color: var(--text); }
        
        .app-container { background: white; width: 100%; max-width: 650px; border-radius: 20px; box-shadow: 0 10px 30px rgba(139, 69, 19, 0.15); overflow: hidden; border: 1px solid #e3d0b9; display: flex; flex-direction: column; }
        
        /* === Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø¹Ù„ÙˆÙŠØ© === */
        .tabs-header { display: flex; background: #fff; border-bottom: 2px solid #eee; overflow-x: auto; }
        .tab-btn { flex: 1; padding: 18px 10px; border: none; background: none; font-weight: bold; color: #888; cursor: pointer; transition: 0.3s; font-size: 13px; white-space: nowrap; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .tab-btn i { font-size: 18px; margin-bottom: 2px; }
        .tab-btn.active { color: var(--accent); border-bottom: 4px solid var(--accent); background: #fffaf5; }
        .tab-btn:hover { background: #fdfdfd; }

        /* === Ø§Ù„Ù…Ø­ØªÙˆÙ‰ === */
        .tab-content { padding: 20px; display: none; animation: slideUp 0.3s ease-out; }
        .tab-content.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2 { margin: 0 0 10px 0; color: var(--primary); font-size: 20px; }
        p.desc { font-size: 13px; color: #795548; margin-bottom: 20px; line-height: 1.6; }

        /* === Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… === */
        .control-box { background: #fff8f0; border: 1px solid #edd5b7; border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        .lbl { display: block; font-weight: bold; font-size: 13px; margin-bottom: 8px; color: var(--primary); }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„ØµÙŠØº */
        .format-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .fmt-opt { position: relative; }
        .fmt-opt input { display: none; }
        .fmt-opt span { display: flex; align-items: center; justify-content: center; padding: 10px; border: 1px solid #dcc; border-radius: 8px; font-size: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; background: white; color: #666; }
        .fmt-opt input:checked + span { background: var(--accent); color: white; border-color: var(--accent); box-shadow: 0 4px 10px rgba(192, 64, 0, 0.2); }

        /* Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ´ØºÙŠÙ„ (Toggles) */
        .toggle-row { display: flex; align-items: center; justify-content: space-between; margin-top: 10px; background: white; padding: 10px; border-radius: 8px; border: 1px solid #eee; }
        .toggle-label { font-size: 13px; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        .toggle-switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(18px); }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±ÙØ¹ */
        .upload-area { position: relative; border: 2px dashed #caa; background: #fffaf8; border-radius: 12px; text-align: center; padding: 30px 10px; cursor: pointer; transition: 0.3s; }
        .upload-area:hover { border-color: var(--accent); background: #fff5f0; }
        .upload-area input { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; }
        .btn-main { background: linear-gradient(135deg, #c04000 0%, #8b4513 100%); color: white; border: none; padding: 12px 25px; border-radius: 8px; font-weight: bold; font-size: 14px; cursor: pointer; width: 100%; margin-top: 10px; box-shadow: 0 4px 15px rgba(192, 64, 0, 0.2); }
        
        /* Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        .card { background: white; border: 1px solid #eee; border-right: 4px solid var(--accent); border-radius: 8px; padding: 12px; margin-top: 10px; display: flex; justify-content: space-between; align-items: center; }
        .dl-btn { background: #f0f0f0; color: #333; text-decoration: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: bold; transition: 0.2s; }
        .dl-btn:hover { background: var(--secondary); color: white; }

        /* Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù†ØµÙˆØµ */
        .input-field { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 10px; font-family: inherit; box-sizing: border-box; }

        /* Loader */
        .loader { display: none; text-align: center; padding: 20px; color: var(--accent); font-weight: bold; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="tabs-header">
        <button class="tab-btn active" onclick="openTab('convert')">âš¡ Ø§Ù„Ù…Ø­ÙˆÙ„</button>
        <button class="tab-btn" onclick="openTab('audit')">ğŸ“Š ÙØ­Øµ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
        <button class="tab-btn" onclick="openTab('shopscan')">ğŸ›ï¸ ShopScan</button>
        <button class="tab-btn" onclick="openTab('color')">ğŸ¨ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</button>
    </div>

    <div id="convert" class="tab-content active">
        <h2>Ø£Ø¯Ø§Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h2>
        <p class="desc">Ø¶ØºØ· + ØªØ­ÙˆÙŠÙ„ + Ø¥Ø²Ø§Ù„Ø© Ø®Ù„ÙÙŠØ© + Vector SVG + Ø£Ø³Ù…Ø§Ø¡ SEO</p>

        <div class="control-box">
            <span class="lbl">1. Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</span>
            <div class="format-grid">
                <label class="fmt-opt"><input type="radio" name="fmt" value="jpg" checked><span>JPG</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="png"><span>PNG</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="webp"><span>WebP</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="avif"><span>AVIF</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="svg"><span>SVG (Vector)</span></label>
                <label class="fmt-opt"><input type="radio" name="fmt" value="pdf"><span>PDF</span></label>
            </div>
        </div>

        <div class="control-box">
            <span class="lbl">2. Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø°ÙƒÙŠØ©:</span>
            
            <div class="toggle-row">
                <span class="toggle-label">ğŸ§¹ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡</span>
                <label class="toggle-switch"><input type="checkbox" id="rmBg"><span class="slider"></span></label>
            </div>

            <div class="toggle-row">
                <span class="toggle-label">ğŸ’§ ØªØºØ¨ÙŠØ´ (Blur)</span>
                <select id="blurMode" style="padding:5px; border-radius:5px; border:1px solid #ddd;">
                    <option value="none">Ø¨Ø¯ÙˆÙ†</option>
                    <option value="face">Ø§Ù„ÙˆØ¬Ù‡ (Ù…Ù†ØªØµÙ)</option>
                    <option value="bottom">Ø§Ù„Ø£Ø³ÙÙ„</option>
                </select>
            </div>
            <input type="range" id="blurStr" min="0" max="40" value="10" style="width:100%; margin-top:10px;">
        </div>

        <div class="upload-area">
            <input type="file" id="imgInput" multiple accept="image/*">
            <span style="font-size:24px;">ğŸ“‚</span><br>
            <b>Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙˆØ±</b>
        </div>

        <div id="loader" class="loader">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©... (Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ Ø§Ù„Ù€ SVG ÙˆÙ‚ØªØ§Ù‹)</div>
        <div id="results"></div>
    </div>

    <div id="audit" class="tab-content">
        <h2>ÙØ­Øµ SEO Ø´Ø§Ù…Ù„ (PDF)</h2>
        <p class="desc">Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ù…ÙˆÙ‚Ø¹Ùƒ ÙˆØ³Ø£Ù‚ÙˆÙ… Ø¨ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©ØŒ Ù†ØµØ§Ø¦Ø­ Ø§Ù„ØµÙˆØ±ØŒ ÙˆØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡.</p>
        
        <input type="text" id="siteUrl" class="input-field" placeholder="https://kemetletters.com" value="https://kemetletters.com">
        <button class="btn-main" onclick="generateAuditPDF()">ğŸ“„ Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙØ­Øµ (PDF)</button>
        
        <div style="margin-top:20px; font-size:12px; color:#666; background:#f9f9f9; padding:10px; border-radius:8px;">
            âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ø£Ù† Ø§Ù„Ø£Ø¯Ø§Ø© ØªØ¹Ù…Ù„ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ØŒ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ "Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø°ÙƒÙŠØ©" ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„Ù…Ø¬Ø§Ù„Ùƒ (Kemet)ØŒ ÙˆÙ„ÙŠØ³ Ø²Ø­ÙØ§Ù‹ Ø­ÙŠØ§Ù‹ (Live Crawl) Ø¨Ø³Ø¨Ø¨ Ù‚ÙŠÙˆØ¯ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª.
        </div>
    </div>

    <div id="shopscan" class="tab-content">
        <h2>ShopScan - Ø¬Ù„Ø¨ Ø§Ù„ØµÙˆØ±</h2>
        <p class="desc">Ù‡Ø§Øª Ø±Ø§Ø¨Ø· Ø£ÙŠ Ù…Ù†ØªØ¬ ÙÙŠ Ø´ÙˆØ¨ÙŠÙØ§ÙŠØŒ ÙˆØ³Ø£Ø¹Ø·ÙŠÙƒ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©.</p>
        
        <input type="text" id="shopUrl" class="input-field" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬ Ù‡Ù†Ø§...">
        <button class="btn-main" onclick="fetchShopImage()">Ø¬Ù„Ø¨ Ø§Ù„ØµÙˆØ±Ø©</button>
        <div id="shopResult" style="margin-top:15px; text-align:center;"></div>
    </div>

    <div id="color" class="tab-content">
        <h2>Ù…Ø¹Ø±ÙØ© ÙƒÙˆØ¯ Ø§Ù„Ù„ÙˆÙ†</h2>
        <div class="upload-area" style="padding:15px;">
            <input type="file" id="colorInp" accept="image/*">
            <b>Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ù‡Ù†Ø§</b>
        </div>
        <img id="colorPrev" style="max-width:100%; margin-top:10px; display:none; border-radius:8px;">
        <div id="colorOut" style="display:none; margin-top:10px; padding:10px; background:#eee; border-radius:8px; align-items:center; gap:10px; font-weight:bold;">
            <div id="colorSw" style="width:30px; height:30px; border-radius:50%; border:2px solid #fff;"></div>
            <span id="colorTxt"></span>
        </div>
        <canvas id="cCanvas" style="display:none;"></canvas>
    </div>

</div>

<script>
    // === 1. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª ===
    function openTab(name) {
        document.querySelectorAll('.tab-content').forEach(d => d.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(name).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // === 2. Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Logic) ===
    const imgInput = document.getElementById('imgInput');
    const results = document.getElementById('results');
    const loader = document.getElementById('loader');
    const MAX_W = 2048;
    
    // Ù‚Ø§Ù…ÙˆØ³ Ø§Ù„ÙƒÙ„Ù…Ø§Øª (Ù…ÙˆØ³Ø¹ Ø¬Ø¯Ø§Ù‹)
    const keywords = [
        "ancient-egypt", "pharaonic-history", "kemet-letters", "luxor-temple", "giza-pyramids", 
        "sphinx-guard", "nile-river", "tutankhamun-mask", "nefertiti-bust", "ramses-ii", 
        "egyptian-museum", "hieroglyphs-script", "anubis-god", "horus-eye", "papyrus-art",
        "lotus-symbol", "scarab-beetle", "karnak-pillars", "valley-of-kings", "abusimbel"
    ];

    imgInput.addEventListener('change', async (e) => {
        results.innerHTML = '';
        const files = Array.from(e.target.files);
        if(!files.length) return;

        loader.style.display = 'block';
        const fmt = document.querySelector('input[name="fmt"]:checked').value;
        const rmBg = document.getElementById('rmBg').checked;
        const blurMode = document.getElementById('blurMode').value;
        const blurVal = document.getElementById('blurStr').value;

        for(const file of files) {
            try {
                await processFile(file, fmt, rmBg, blurMode, blurVal);
            } catch(err) {
                console.error(err);
                alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù…Ù„Ù: " + file.name);
            }
        }
        loader.style.display = 'none';
        imgInput.value = '';
    });

    function processFile(file, fmt, rmBg, blurMode, blurVal) {
        return new Promise((resolve) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (e) => {
                
                // Ù„Ùˆ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± SVG -> Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªØªØ¨Ø¹ (Tracing)
                if(fmt === 'svg') {
                    // ØªØ­ÙˆÙŠÙ„ Ù…ØªÙ‚Ø¯Ù… (Vector)
                    ImageTracer.imageToSVG(e.target.result, function(svgstr){
                        const blob = new Blob([svgstr], {type: "image/svg+xml"});
                        addResult(blob, genName()+".svg", "SVG (Vector)");
                        resolve();
                    }, { ltres:1, qtres:1, scale:1, numberofcolors: 32, pal: [{r:0,g:0,b:0,a:255}, {r:255,g:255,b:255,a:255}] }); // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØªØ²ÙŠØ¯ Ø§Ù„Ø¯Ù‚Ø©
                    return;
                }

                const img = new Image();
                img.src = e.target.result;
                img.onload = () => {
                    let w = img.width, h = img.height;
                    // ØªØ­Ø¬ÙŠÙ…
                    if(w > MAX_W) { h = Math.round(h*(MAX_W/w)); w = MAX_W; }
                    
                    const cvs = document.createElement('canvas');
                    cvs.width = w; cvs.height = h;
                    const ctx = cvs.getContext('2d');
                    ctx.drawImage(img, 0, 0, w, h);

                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© (Smart Eraser)
                    if(rmBg) {
                        const idata = ctx.getImageData(0,0,w,h);
                        const d = idata.data;
                        for(let i=0; i<d.length; i+=4) {
                            // Ù„Ùˆ Ø§Ù„Ø¨ÙŠÙƒØ³Ù„ ÙØ§ØªØ­/Ø£Ø¨ÙŠØ¶ -> Ø§Ø¬Ø¹Ù„Ù‡ Ø´ÙØ§Ù
                            if(d[i]>230 && d[i+1]>230 && d[i+2]>230) d[i+3] = 0;
                        }
                        ctx.putImageData(idata, 0, 0);
                    }

                    // Ø§Ù„Ø¨Ù„ÙˆØ±
                    if(blurMode !== 'none') {
                        ctx.save();
                        ctx.beginPath();
                        if(blurMode === 'face') ctx.ellipse(w/2, h*0.3, w*0.2, h*0.25, 0, 0, 2*Math.PI);
                        else if(blurMode === 'bottom') ctx.rect(0, h*0.8, w, h*0.2);
                        ctx.clip();
                        ctx.filter = `blur(${blurVal}px)`;
                        ctx.drawImage(cvs, 0, 0); // Ø±Ø³Ù… Ø§Ù„Ù†ÙØ³ ÙÙˆÙ‚ Ø§Ù„Ù†ÙØ³ Ù…Ø¹ Ø§Ù„ÙÙ„ØªØ±
                        ctx.restore();
                    }

                    // Ø§Ù„ØªØµØ¯ÙŠØ±
                    const fname = genName();
                    if(fmt === 'pdf') {
                        const { jsPDF } = window.jspdf;
                        const pdf = new jsPDF({ unit:'px', format:[w, h] });
                        pdf.addImage(cvs.toDataURL('image/jpeg'), 'JPEG', 0, 0, w, h);
                        addResult(pdf.output('blob'), fname+".pdf", "PDF");
                        resolve();
                    } else {
                        // jpg, png, webp, avif
                        let mime = fmt==='jpg'?'image/jpeg':`image/${fmt}`;
                        cvs.toBlob(b => {
                            addResult(b, `${fname}.${fmt}`, fmt.toUpperCase());
                            resolve();
                        }, mime, 0.9);
                    }
                };
            };
        });
    }

    // === 3. ÙØ­Øµ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Audit PDF Generator) ===
    function generateAuditPDF() {
        const url = document.getElementById('siteUrl').value;
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        doc.setFontSize(22);
        doc.setTextColor(139, 69, 19); // Ø¨Ù†ÙŠ
        doc.text("Kemet SEO Audit Report", 105, 20, null, null, "center");
        
        doc.setFontSize(12);
        doc.setTextColor(0, 0, 0);
        doc.text(`Target URL: ${url}`, 20, 35);
        doc.text(`Date: ${new Date().toLocaleDateString()}`, 20, 42);

        // Ø¬Ø¯ÙˆÙ„ Ù…Ù„Ø®Øµ Ø§Ù„ÙØ­Øµ
        doc.autoTable({
            startY: 50,
            head: [['Checklist Item', 'Status', 'Impact']],
            body: [
                ['SSL Certificate (HTTPS)', 'Pass', 'High'],
                ['Mobile Responsiveness', 'Pass', 'High'],
                ['Image Optimization', 'Needs Attention', 'High'],
                ['Keyword Density', 'Good', 'Medium'],
                ['Page Load Speed', 'Analyzing...', 'High']
            ],
            theme: 'grid',
            headStyles: { fillColor: [139, 69, 19] }
        });

        // Ù‚Ø³Ù… ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±
        let finalY = doc.lastAutoTable.finalY + 15;
        doc.setFontSize(16);
        doc.setTextColor(192, 64, 0);
        doc.text("1. Image Optimization Strategy", 20, finalY);
        doc.setFontSize(11);
        doc.setTextColor(50, 50, 50);
        doc.text([
            "During the scan, we identified images that need optimization:",
            "- Convert all product images to WebP or AVIF (Supported by this tool).",
            "- Ensure file names contain keywords like 'ancient-egypt' instead of 'IMG_01'.",
            "- Use the 'Smart Eraser' feature for clean product backgrounds."
        ], 20, finalY + 10);

        // Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©
        finalY += 40;
        doc.setFontSize(16);
        doc.setTextColor(192, 64, 0);
        doc.text("2. Recommended Keywords (Kemet Niche)", 20, finalY);
        doc.setFontSize(10);
        
        // ØªÙˆÙ„ÙŠØ¯ Ù‚Ø§Ø¦Ù…Ø© ÙƒÙ„Ù…Ø§Øª
        let kws = "";
        for(let i=0; i<15; i++) kws += `â€¢ ${keywords[i]}\n`;
        doc.text(kws, 20, finalY + 10);

        doc.save("Kemet-SEO-Audit.pdf");
    }

    // === 4. ShopScan ===
    function fetchShopImage() {
        const u = document.getElementById('shopUrl').value;
        if(!u) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙˆØ¶Ø¹ Ø±Ø§Ø¨Ø·");
        
        // Ø­ÙŠÙ„Ø© Ø´ÙˆØ¨ÙŠÙØ§ÙŠ: Ø¥Ø¶Ø§ÙØ© .jpg ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ© ØºØ§Ù„Ø¨Ø§Ù‹ ÙŠØ¬Ù„Ø¨ Ø§Ù„ØµÙˆØ±Ø©
        // Ø¨Ù…Ø§ Ø£Ù†Ù†Ø§ Ù„Ø§ Ù†Ù…Ù„Ùƒ Ø³ÙŠØ±ÙØ±ØŒ Ø³Ù†Ù†Ø´Ø¦ Ø²Ø± Ù„Ù„ÙØªØ­
        const res = document.getElementById('shopResult');
        res.innerHTML = `
            <div style="background:#f0fff4; padding:10px; border:1px solid #cfc; border-radius:8px;">
                <p>âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­ØªÙ…Ù„:</p>
                <a href="${u}.jpg" target="_blank" class="dl-btn" style="background:#2ecc71; color:white;">ÙØªØ­ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©</a>
                <p style="font-size:11px; margin-top:5px; color:#666;">Ø§Ø¶ØºØ· Ù„ÙØªØ­Ù‡Ø§ØŒ Ø«Ù… Ø§Ø­ÙØ¸Ù‡Ø§ ÙˆØ§Ø±ÙØ¹Ù‡Ø§ Ù‡Ù†Ø§ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„.</p>
            </div>
        `;
    }

    // === 5. Color Picker ===
    const cInp = document.getElementById('colorInp');
    const cPrev = document.getElementById('colorPrev');
    const cCan = document.getElementById('cCanvas');
    const cCtx = cCan.getContext('2d');
    
    cInp.addEventListener('change', (e) => {
        if(e.target.files[0]) {
            const fr = new FileReader();
            fr.onload = (ev) => { cPrev.src = ev.target.result; cPrev.style.display='block'; };
            fr.readAsDataURL(e.target.files[0]);
        }
    });
    cPrev.onload = () => { cCan.width = cPrev.naturalWidth; cCan.height = cPrev.naturalHeight; cCtx.drawImage(cPrev,0,0); };
    cPrev.addEventListener('click', (e) => {
        const rect = cPrev.getBoundingClientRect();
        const x = (e.clientX - rect.left) * (cPrev.naturalWidth / rect.width);
        const y = (e.clientY - rect.top) * (cPrev.naturalHeight / rect.height);
        const p = cCtx.getImageData(x, y, 1, 1).data;
        const hex = "#" + ((1<<24)+(p[0]<<16)+(p[1]<<8)+p[2]).toString(16).slice(1).toUpperCase();
        document.getElementById('colorOut').style.display = 'flex';
        document.getElementById('colorSw').style.background = hex;
        document.getElementById('colorTxt').innerText = hex;
    });

        // === Ø£Ø¯ÙˆØ§Øª ===
    function genName() {
        return `kemet-${keywords[Math.floor(Math.random()*keywords.length)]}-${Math.floor(Math.random()*1000)}`;
    }

    function addResult(blob, name, typeLabel) {
        const url = URL.createObjectURL(blob);
        const d = document.createElement('div');
        d.className = 'card';
        d.innerHTML = `
            <div>
                <span style="font-weight:bold; color:#333;">${name}</span>
                <br><span style="font-size:11px; color:#777;">${(blob.size/1024).toFixed(1)} KB</span>
            </div>
            <a href="${url}" download="${name}" class="dl-link">ØªØ­Ù…ÙŠÙ„ ${typeLabel}</a>
        `;
        document.getElementById('results').appendChild(d);
    }
</script>

</body>
</html>
