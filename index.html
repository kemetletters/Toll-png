<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¶Ø§ØºØ· ØµÙˆØ± Shopify (Ø®ÙÙŠÙ)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f6f8; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: white; width: 100%; max-width: 500px; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; }
        h2 { color: #202e3e; margin-bottom: 10px; }
        .upload-btn-wrapper { position: relative; overflow: hidden; display: inline-block; margin-bottom: 20px; width: 100%; }
        .btn { border: 2px dashed #008060; color: #008060; background-color: #f1f8f5; padding: 20px; border-radius: 8px; font-size: 16px; font-weight: bold; width: 100%; cursor: pointer; display: block; box-sizing: border-box; }
        .btn:hover { background-color: #e3f1ec; }
        .upload-btn-wrapper input[type=file] { font-size: 100px; position: absolute; left: 0; top: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%; }
        
        .status-area { margin-top: 20px; text-align: right; max-height: 400px; overflow-y: auto; }
        .item { background: #fff; border-bottom: 1px solid #eee; padding: 10px; display: flex; justify-content: space-between; align-items: center; }
        .item span { font-size: 13px; color: #333; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 60%; }
        .download-link { background: #008060; color: white; text-decoration: none; padding: 5px 12px; border-radius: 4px; font-size: 12px; }
        .note { font-size: 12px; color: #666; margin-top: 10px; background: #fff3cd; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Ø£Ø¯Ø§Ø© Ø´ÙˆØ¨ÙŠÙØ§ÙŠ (ØªØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø³ÙŠØ±ÙØ±)</h2>
    <p style="color:#666; font-size:14px;">ÙŠØ¶Ø¨Ø· Ø§Ù„Ù…Ù‚Ø§Ø³ 2048px + ÙŠÙ†Ø¸Ù Ø§Ù„Ø§Ø³Ù…</p>
    
    <div class="upload-btn-wrapper">
        <button class="btn">ğŸ“‚ Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ± Ù…Ù† Ù‡Ù†Ø§</button>
        <input type="file" id="uploadInput" multiple accept="image/jpeg, image/png, image/webp">
    </div>

    <div id="output" class="status-area"></div>
    
    <div class="note">
        âš ï¸ Ù†ØµÙŠØ­Ø©: Ø¨Ù…Ø§ Ø£Ù† Ø¬Ù‡Ø§Ø²Ùƒ Ø¨Ø·ÙŠØ¡ØŒ Ø§Ø®ØªØ± 5-10 ØµÙˆØ± ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ù…Ø±Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© Ø­ØªÙ‰ Ù„Ø§ ÙŠØªØ´Ù†Ø¬ Ø§Ù„Ù…ØªØµÙØ­.
    </div>
</div>

<script>
    const MAX_WIDTH = 2048;
    const QUALITY = 0.8; // Ø¬ÙˆØ¯Ø© 80%

    document.getElementById('uploadInput').addEventListener('change', function(e) {
        const files = e.target.files;
        const outputDiv = document.getElementById('output');
        outputDiv.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ…

        if (files.length === 0) return;

        Array.from(files).forEach(file => {
            const reader = new FileReader();
            
            reader.onload = function(event) {
                const img = new Image();
                img.src = event.target.result;
                
                img.onload = function() {
                    // 1. Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                    let width = img.width;
                    let height = img.height;

                    if (width > MAX_WIDTH) {
                        height = Math.round(height * (MAX_WIDTH / width));
                        width = MAX_WIDTH;
                    }

                    // 2. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³ Ù„Ù„Ø±Ø³Ù…
                    const canvas = document.createElement('canvas');
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);

                    // 3. ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø§Ø³Ù… (SEO)
                    let cleanName = file.name.split('.').slice(0, -1).join('.').toLowerCase();
                    cleanName = cleanName.replace(/[^a-z0-9]+/g, '-') + ".jpg"; // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒÙ„ Ù„Ù€ JPG

                    // 4. Ø¶ØºØ· ÙˆØªØµØ¯ÙŠØ±
                    canvas.toBlob(function(blob) {
                        const url = URL.createObjectURL(blob);
                        
                        // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
                        const item = document.createElement('div');
                        item.className = 'item';
                        item.innerHTML = `
                            <span>${cleanName}</span>
                            <a href="${url}" download="${cleanName}" class="download-link">ØªØ­Ù…ÙŠÙ„</a>
                        `;
                        outputDiv.appendChild(item);
                        
                    }, 'image/jpeg', QUALITY);
                }
            }
            reader.readAsDataURL(file);
        });
    });
</script>

</body>
</html>
